syntax = "proto3";

package ait.game;

service GameService {
  // 1. Get user key for the game
  rpc GetUserKeyForGame(GetUserKeyForGameRequest) returns (GetUserKeyForGameResponse);

  // 2. Grant promotion reward
  rpc GrantPromotionReward(GrantPromotionRewardRequest) returns (GrantPromotionRewardResponse);

  // 3. Open the game leaderboard
  rpc OpenGameCenterLeaderboard(OpenGameCenterLeaderboardRequest) returns (OpenGameCenterLeaderboardResponse);

  // 4. Submit score to the game leaderboard
  rpc SubmitGameCenterLeaderboardScore(SubmitGameCenterLeaderboardScoreRequest) returns (SubmitGameCenterLeaderboardScoreResponse);
}

// -------------------------------------------------------------------
// Messages for GetUserKeyForGame
// -------------------------------------------------------------------

message GetUserKeyForGameRequest {}

message GetUserKeyForGameResponse {
  oneof result {
    GetUserKeyForGameSuccessResponse success = 1;
    GetUserKeyForGameErrorResponse error = 2;
  }
}

message GetUserKeyForGameSuccessResponse {
  string type = 1; // e.g., "HASH"
  string hash = 2;
}

message GetUserKeyForGameErrorResponse {
  enum ErrorType {
    INVALID_CATEGORY = 0;
    ERROR = 1;
    UNDEFINED_VERSION = 2;
  }
  ErrorType type = 1;
  string message = 2;
}

// -------------------------------------------------------------------
// Messages for GrantPromotionReward
// -------------------------------------------------------------------

message GrantPromotionRewardRequest {
  string promotion_code = 1;
  int32 amount = 2;
}

message GrantPromotionRewardResponse {
  oneof result {
    GrantPromotionRewardSuccessResponse success = 1;
    GrantPromotionRewardErrorResponse error = 2;
  }
}

message GrantPromotionRewardSuccessResponse {
  string key = 1; // Reward key
}

message GrantPromotionRewardErrorResponse {
  string error_code = 1;
  string message = 2;
}

// -------------------------------------------------------------------
// Messages for OpenGameCenterLeaderboard
// -------------------------------------------------------------------

message OpenGameCenterLeaderboardRequest {}
message OpenGameCenterLeaderboardResponse {}

// -------------------------------------------------------------------
// Messages for SubmitGameCenterLeaderboardScore
// -------------------------------------------------------------------

message SubmitGameCenterLeaderboardScoreRequest {
  string score = 1;
}

message SubmitGameCenterLeaderboardScoreResponse {
  string status_code = 1; // e.g., "SUCCESS"
}